jetstarAncillary=(function(){var isIE6=false;var isIE7=false;var _possibleDates;var timeoutInterval;var timeoutExpired;var insurance={selector:"#main .ancillary-insurance",container:[],culture:"",neutral:true,init:function(){this.container=$(this.selector);if(this.container.length){this.bind();this.culture=this.container.attr("data-culture")}var optIn=this.container.find("input:checked");if(optIn.length==0){$(this.selector+" .product-opt").addClass("opt-neutral")}else{$(this.selector+" .product-opt").removeClass("opt-neutral").find("input:checked").trigger("change");this.toggle(optIn.val());this.neutral=false}$(this.selector+" .row-required input").each(function(){insurance.rowRequired($(this))})},bind:function(){$(this.selector+" .product-opt input").change(function(){var $this=$(this);insurance.toggle($this.val());if(insurance.neutral){$this.closest(".product-opt").removeClass("opt-neutral");this.neutral=false}});$(this.selector+" .row-required input").change(function(){insurance.rowRequired($(this))});$(this.selector+" .product-remove a").click(function(e){e.preventDefault();$(insurance.selector+" .product-opt input[value=jetcoverNo]").click();util.scrollTo("a[name=insurance]")})},toggle:function(value){$(".error-alert").hide();if(value=="jetcoverYes"){this.add()}else{if(value=="jetcoverNo"){this.remove()}}},add:function(){if(this.neutral){$(this.selector+" .info-neutral").hide()}var productOpt=$(this.selector+" .product-opt");if(!productOpt.hasClass("opt-added")){$(this.selector+" .product-opt").addClass("opt-added");$(this.selector+" .product-manage select, "+this.selector+" .product-manage .row-required input").addClass("required");$(this.selector+" .product-manage").removeClass("hidden").slideDown()}},remove:function(){var productOpt=$(this.selector+" .product-opt");if(productOpt.hasClass("opt-added")){productOpt.removeClass("opt-added");$(this.selector+" .product-manage select").removeClass("required");$(this.selector+" .product-manage").slideUp(function(){$(this).addClass("hidden")});$(this.selector+" .row-required input").prop("checked",false).removeClass("required").parent().addClass("invalid")}else{$(this.selector+" .product-manage select").removeClass("required");$(this.selector+" .info-neutral").hide()}},rowRequired:function(obj){if(obj.is(":checked")){obj.closest(".row-required").removeClass("invalid")}else{obj.closest(".row-required").addClass("invalid")}}};var insuranceAccc={wrapper:".ancillary-insurance.style-two",manageSection:".product-manage-pax",ancillaryPanel:".ancillary-insurance.style-two .ancillary-panel",init:function(){this.$wrapper=$(this.wrapper);this.$managePax=$(this.manageSection);this.$ancillaryPanel=this.$wrapper.find(this.ancillaryPanel);this.bind()},bind:function(){var $inputSelection=$(insuranceAccc.wrapper+" .ancillary-cost").find(".btn-wrap input:radio");$(this.wrapper).find("input").change(function(e){var $this=$(this);if($this.is(":checked")){insuranceAccc.toggle($this.val());insuranceAccc.checkOptState($this);insuranceAccc.checkErrors();return false}}).trigger("change");$(".btn-continue").click(function(){var $this=$(this);if($this.hasClass("disabled")){return false}else{if($inputSelection.is(":checked")){return true}else{$(insuranceAccc.wrapper+" .ancillary-cost").removeClass("opt-neutral").addClass("opt-invalid");insuranceAccc.checkErrors();return false}}})},checkErrors:function(){var $errorsVisible=null,$errorTargets=null;$(insuranceAccc.wrapper).removeClass("invalid-box");$(insuranceAccc.wrapper).siblings(".opt-selection, .pax-manage-select").hide();var $errorsVisible=$(insuranceAccc.wrapper+" .ancillary-cost.opt-invalid"),$errorTargets=$errorsVisible.closest(".error-target");if($errorsVisible.length){$errorTargets.addClass("invalid-box");$errorTargets.siblings(".opt-selection").show();$("html,body").animate({scrollTop:$errorsVisible.first().offset().top-200},"slow")}else{$errorTargets.removeClass("invalid-box");$errorTargets.siblings(".opt-selection").hide()}},toggle:function(val){if(val=="yes"){this.add();return false}else{if(val=="no"){this.remove();return false}}},add:function(){$(".insurance-yes").click();isIE7?this.$managePax.show():this.$managePax.slideDown();this.$wrapper.find("select").addClass("required").removeClass("error").siblings(".error").remove()},remove:function(){$(".insurance-no").click();this.$wrapper.find("select").removeClass("required");isIE7?this.$managePax.hide():this.$managePax.slideUp(function(){$(this).hide()})},checkOptState:function(optTrigger){var optTrigger=optTrigger;if(optTrigger.is(":checked")){$(insuranceAccc.wrapper+" .ancillary-cost").removeClass("opt-neutral opt-invalid");if(optTrigger.val()=="no"){$(".alertbox.insurance-info").slideUp(150)}}}};var ancillary={init:function(){function addAnc(thisDl){var thisDlClass=thisDl.attr("class");if(thisDl.hasClass("meals")){if(thisDlClass==="Vegetarian"){$("dd.mealsAdded img.omnivore").hide();$("dd.mealsAdded img.vegetarian").show()}else{$("dd.mealsAdded img.vegetarian").hide();$("dd.mealsAdded img.omnivore").show()}thisDl.find('select option[value="'+(thisDlClass=="Regular"?"SPML":"VGML")+'"]').prop("selected",true);$("dd.mealsAdded span.mealType").text(thisDlClass)}else{if(thisDl.is(".entertain, .comfort, .ancillary-lounge")){thisDl.find('select option[data-price!="0"]').prop("selected",true)}}$(thisDl.find("dd.options, a.ancillary-add")).fadeOut(function(){$(thisDl.find("dd.ddAdded, .product-added")).fadeIn();$(thisDl.find("dd.manageAll, .product-manage-open")).hide()});rhs.updateSummary(thisDl)}function remAnc(thisDl){if(thisDl.is(".meals")){$("dd.mealsAdded span.mealType").text("")}$(thisDl.find("dd.ddAdded, .product-added")).fadeOut(function(){$(thisDl.find("dd.options, a.ancillary-add")).fadeIn();$(thisDl.find("dd.manageAll, .product-manage-open")).show()})}function addAll(thisDl){var theseDD=thisDl.find('.ddAdded, .manageAll, .options, .manageAll, .ancillary-add, .product-manage, p:has("a.product-manage-open")');$.each(theseDD,function(){$(this).slideUp("fast")});thisDl.find("dd.manageBaggage, .product-manage-close, .product-manage").slideDown("slow")}function remAll(thisDl){thisDl.find("dd.manageBaggage, .product-manage-close, .product-manage").slideUp("fast")}$(".tooltip-trigger").tooltip({position:"bottom center",offset:[-4,44],relative:true,predelay:250,delay:400,effect:"fade",tipMessageWrapClass:".tooltip-help"});$(".tooltip-trigger-relative").tooltip({position:"bottom center",offset:[-4,44],relative:true,predelay:250,delay:400,effect:"fade"});$("a.manage--all-pax-trigger, a.product-manage-close").click(function(event){var $this=$(this).parents(".meals, .entertain, .comfort, .ancillary-lounge");event.preventDefault();$this.find('dd.manageAll, .product-manage, p:has("a.product-manage-open")').show();remAnc($this);remAll($this)});$("a.manage--all-trigger, a.updateMeal, a.product-manage-open").click(function(event){var $this=$(this).parents(".meals, .entertain, .comfort, .ancillary-lounge");event.preventDefault();addAll($this)});$("dd.ddAdded a.removeAnc, .product-cancel").click(function(event){var $this=$(this).parents(".meals, .entertain, .comfort, .ancillary-lounge, .parking");event.preventDefault();$this.find("select").prop("selectedIndex",0).addClass("default");rhs.updateSummary($this);remAnc($this)});$("dd.options a, a.ancillary-add").click(function(event){var thisDl=$(this).parents(".meals, .entertain, .comfort, .ancillary-lounge, .parking");event.preventDefault();addAnc(thisDl)});$(".ancillary-lounge .hidden-content-trigger").click(function(e){var $this=$(this);e.preventDefault();$this.toggleClass("open").parent().next().slideToggle();$this.text($this.hasClass("open")?$this.attr("data-label-more"):$this.attr("data-label-less"))});$(".add-inflight-each, .ancillary-lounge select, .ancillary-insurance input[type=radio]").change(function(){if($(".ancillary-insurance.style-two").length){if($.browser.msie&&parseFloat($.browser.version)<9){if($(this).is(":radio")&&$(this).is(":checked")){insuranceAccc.toggle($(this).val())}}}rhs.updateSummary($(this).parents(".meals, .entertain, .comfort, .ancillary-lounge, .ancillary-insurance"))});$(".select-copyall").click(function(event){var index=$(this).siblings("select").prop("selectedIndex");$(this).parent().siblings("div").children("select").prop("selectedIndex",index).removeClass("default").trigger("change");event.preventDefault()});$(".passenger input.default, .passenger select.default").each(function(){var input=$(this),inputVal=(input.is("select")?$(this).children().first().val():input.val());input.bind("focusin",function(){input.removeClass("default");if(input.val()!=inputVal){return false}input.val("")});input.blur(function(){if(input.val()==""){input.addClass("default");input.val(inputVal)}if(input.val()==inputVal){input.addClass("default")}$(".select-areacode").removeClass("default")});input.focusin();input.blur()})}};return{init:function(){if(window.console==undefined){window.console={log:function(){}}}hasExtrasInPage=true;isIE6=($("html").hasClass("ie6")?true:false);if($("#Activities").length==0){jetstarAncillary.datePick(".date-pick",1)}$(".max-age").change(function(){var pos=$(this).attr("position");function pad(val){if(val.length<2){return"0"+val}return val}var dateValue=$("#year"+pos).val()+pad($("#month"+pos).val())+pad($("#day"+pos).val());$("#dateValue"+pos).val(dateValue)});$.validator.addMethod("maxAge",function(value,e){if($("input[value=jetcoverNo]").is(":checked")){return true}var pos=$(e).attr("position");function pad(val){if(val.length<2){return"0"+val}return val}var dateValue=$("#year"+pos).val()+pad($("#month"+pos).val())+pad($("#day"+pos).val());var limit=$("#product-dob-limit").val();var result=true;if(limit){result=(parseInt(dateValue)>=parseInt(limit))}return result},$("input[name='dateValue']").attr("maxAgeError"));$.validator.addClassRules({dateValue:{maxAge:true}});ancillary.init();insurance.init();if($(".ancillary-insurance.style-two").length){insuranceAccc.init()}this.validation();globalAjax.timeoutWarning()},validation:function(){$("form").validate({onkeyup:false,focusInvalid:false,ignore:".ignore",errorPlacement:function(error,element){if(element.next().hasClass("tooltip-trigger")){error.insertAfter(element.next().next())}else{error.insertAfter(element)}}});$(".btn-continue").click(function(){if($(this).hasClass("disabled")){return false}$(".error-alert").hide();$(".error-target").removeClass("invalid-box");checkErrors=function(){if($(".error:visible, .has-error:visible").length){$(".has-error:visible").addClass("invalid-box");$(".error:visible").closest("div.error-target").addClass("invalid-box");$(".error:visible").closest("div.error-target").prev().show();$("html,body").animate({scrollTop:$(".error:visible, .has-error:visible").first().offset().top-200},"slow")}};if($(".info-neutral:visible").length){$(".ancillary-insurance .product-opt").addClass("has-error");$(".ancillary-insurance .error-alert").show();setTimeout(checkErrors,10);return false}else{setTimeout(checkErrors,10)}})},hotelsLoaded:function(){jetstarAncillary.hotelFunctions();$(".hotels").removeClass("loading");return false},carsLoaded:function(){jetstarAncillary.carsFunctions();$(".cars").removeClass("loading");$(".cars-summary").removeClass("hidden");return false},transfersLoaded:function(){jetstarAncillary.transfersFunctions();$(".transfers").removeClass("loading");$(".transfers-summary").removeClass("hidden");$(".price-select").change();jetstarGATracking.passengerTracking();return false},activitiesLoaded:function(){jetstarAncillary.activitiesFunctions();$(".activities").removeClass("loading");$(".activities-summary").removeClass("hidden");jetstarAncillary.datePick(".date-pick",1);return false},disableContinue:function(){$(".btn-continue").addClass("disabled");$(".error-bottom").show()},enableContinue:function(){$(".btn-continue").removeClass("disabled");$(".error-bottom").hide()},hotelFunctions:function(){var selector=".hotels ";var slider=$(selector+".tab-slider");var hotels=$(selector+".tab-slider li").length;var width=$(selector+".tab-slider li").outerWidth(true);var totalWidth=hotels*width;var maskWidth=$(selector+".tab-container").outerWidth();var scrollLimit=(totalWidth-maskWidth-17)*-1;var count=1;var newActive=0;var animating=false;var slider_position_after_animation=(slider.length>0)?slider.position().left:0;if(totalWidth<=maskWidth){$(selector+".scroll-right").addClass("right-inactive")}$(".hotels .tab-slider").css("width",totalWidth+"px");$(selector+"li.extras-info-item:nth-child(1)").addClass("active-extra").show();$(selector+".extras-tab").click(function(){var selectedHotel=$(this).attr("data-id");$("#HotelImagesContainer .contentWrap").html("");$("#HotelImagesContainer").addClass("darkloading");showHotel(selectedHotel);$(selector+".extras-tab").removeClass("active-tab");$(this).addClass("active-tab");animating=true;return false});$(".trigger-view-rooms").click(function(){$(this).parent().prev().find("li.hidden-room").slideDown();$(this).hide();return false});function updatedPages(page){var pages=Math.max(Math.min(page*3-2,hotels),0);var pageto=Math.max(Math.min(pages+2,hotels),0);$(selector+".extras-page").html("<strong> "+pages+" to "+pageto+" </strong>");$(selector+".extras-number").html("<strong>"+hotels+" Hotels</strong>")}updatedPages(1);function showHotel(i){if($(selector+".active-extra").length&&animating!=true){$(selector+"li.active-extra").fadeOut("fast",function(){$(selector+"li#"+i).fadeIn("fast").addClass("active-extra");animating=false}).removeClass("active-extra")}else{if(animating!=true){$(selector+"li#"+i).fadeIn("fast").addClass("active-extra")}}var href=$(selector+"li#"+i+" .col-right a[data-type='ImagesLink']").attr("href");if(href){HotelImages.LoadHotelImages(href)}}function showHotelAuto(i){newActive=i*3-2;$(selector+".tab-slider li").removeClass("active-tab");$(selector+".tab-slider li:nth-child("+newActive+")").addClass("active-tab");var selectedHotel=$(selector+".tab-slider li:nth-child("+newActive+")").attr("data-id");showHotel(selectedHotel)}var checkActive=function(){if(slider_position_after_animation==5){$(selector+".scroll-left").addClass("left-inactive")}else{$(selector+".scroll-left").removeClass("left-inactive")}if(slider_position_after_animation<=scrollLimit){$(selector+".scroll-right").addClass("right-inactive")}else{$(selector+".scroll-right").removeClass("right-inactive")}};$(selector+".scroll-right").click(function(){if(slider.find(":animated").length){return false}else{if(slider_position_after_animation>scrollLimit){slider.animate({left:"-="+(width*3)},function(){checkActive()});slider_position_after_animation-=width*3;$(selector+".tab-slider li").removeClass("active-tab");count+=1;showHotelAuto(count);updatedPages(count)}}return false});$(selector+".scroll-left").click(function(){if(slider.find(":animated").length){return false}else{if(slider_position_after_animation<5){slider.animate({left:"+="+(width*3)},function(){checkActive()});slider_position_after_animation+=width*3;$(selector+".tab-slider li").removeClass("active-tab");count-=1;showHotelAuto(count);updatedPages(count)}}return false});$(selector+".sort-recommended").click(function(){sortItems("data-recommended","down");$(this).parent().find(".active").removeClass("active");$(this).addClass("active");return false});$(selector+".sort-price").click(function(){sortItems("data-price","down");$(this).parent().find(".active").removeClass("active");$(this).addClass("active");return false});$(selector+".sort-rating").click(function(){sortItems("data-rating","up");$(this).parent().find(".active").removeClass("active");$(this).addClass("active");return false});function sortItems(sortBy,direction){var mylist=$(".hotels .tab-slider");var listitems=mylist.children("li").get();listitems.sort(function(a,b){var compA=$(a).attr(sortBy);var compB=$(b).attr(sortBy);if(direction=="down"){return(compA<compB)?-1:(compA>compB)?1:0}else{if(direction=="up"){return(compA>compB)?-1:(compA<compB)?1:0}}});$.each(listitems,function(idx,itm){mylist.append(itm)});slider.animate({left:"0"},function(){checkActive()});count=1;showHotelAuto(count);updatedPages(count)}$(function(){var currencyPrefix=getCurrencySymbol();var smin=parseInt($(".slider").attr("minprice"));var smax=parseInt($(".slider").attr("maxprice"));var newmin=parseInt($(".slider").attr("newminprice"));if(isNaN(newmin)){newmin=smin}var newmax=parseInt($(".slider").attr("newmaxprice"));if(isNaN(newmax)){newmax=smax}$(".slider").slider({range:true,min:smin,max:smax,values:[newmin,newmax],slide:function(event,ui){$("#amount").text(currencyPrefix+ui.values[0]+" - "+currencyPrefix+ui.values[1]);newmin=ui.values[0];newmax=ui.values[1];$(".slider").attr("newminprice",newmin);$(".slider").attr("newmaxprice",newmax)}});$("#amount").text(currencyPrefix+newmin+" - "+currencyPrefix+newmax);$(".price-filter-trigger").click(function(){return false});function getCurrencySymbol(){var currencyPrefix="$";if($(".currency").text().toLowerCase().indexOf("jpy")>=0){currencyPrefix="\xA5"}return currencyPrefix}})},carsFunctions:function(){var selector=".cars ";var slider=$(selector+".tab-slider");var cars=$(selector+".tab-slider li.car-tab").length;var width=$(selector+".tab-slider li.car-tab").outerWidth(true);var totalWidth=(cars*width)+100;var maskWidth=$(selector+".tab-container").outerWidth();var scrollLimit=(totalWidth-maskWidth-17)*-1;var count=1;var newActive=0;var animating=false;var slider_position_after_animation=(slider.length>0)?slider.position().left:0;if(totalWidth<=maskWidth){$(selector+".scroll-right").addClass("right-inactive")}$(selector+".tab-slider").css("width",totalWidth+"px");function updatedPages(page){var pages=Math.max(Math.min(page*2-1,cars),0);var pageto=Math.max(Math.min(pages+1,cars),0);$(selector+".extras-page").html("<strong> "+pages+" to "+pageto+" </strong>");$(selector+".extras-number").html("<strong>"+cars+" Cars </strong>")}updatedPages(1);var checkActive=function(){if(slider_position_after_animation==5){$(selector+".scroll-left").addClass("left-inactive")}else{$(selector+".scroll-left").removeClass("left-inactive")}if(slider_position_after_animation<=scrollLimit){$(selector+".scroll-right").addClass("right-inactive")}else{$(selector+".scroll-right").removeClass("right-inactive")}};$(selector+".scroll-right").click(function(){if(slider.find(":animated").length){return false}else{if(slider_position_after_animation>scrollLimit){slider.animate({left:"-="+(width*2)},function(){checkActive()});slider_position_after_animation-=width*2;count+=1;updatedPages(count)}}return false});$(selector+".scroll-left").click(function(){if(slider.find(":animated").length){return false}else{if(slider_position_after_animation<5){slider.animate({left:"+="+(width*2)},function(){checkActive()});slider_position_after_animation+=width*2;count-=1;updatedPages(count)}}return false});$(".cars .sort-recommended").click(function(){sortCars("data-recommended","down");$(this).parent().find(".active").removeClass("active");$(this).addClass("active");return false});$(".cars .sort-price").click(function(){sortCars("data-price","down");$(this).parent().find(".active").removeClass("active");$(this).addClass("active");return false});function sortCars(sortBy,direction){var mylist=$(".cars .tab-slider");var listitems=mylist.children("li").get();listitems.sort(function(a,b){var compA=$(a).attr(sortBy);var compB=$(b).attr(sortBy);if(direction=="down"){return(compA<compB)?-1:(compA>compB)?1:0}else{if(direction=="up"){return(compA>compB)?-1:(compA<compB)?1:0}}});$.each(listitems,function(idx,itm){mylist.append(itm)});slider.animate({left:"0"},function(){checkActive()});count=1;updatedPages(count)}},transfersFunctions:function(){var selector=".transfers ",activities=$(selector+".tab-slider li").length;$(selector+"ul.extras-options li input").prop("checked",false);$(selector+"ul.extras-options li input").click(function(e){var $me=$(this),selectedTransfer=$me.attr("data-id");$(selector+"ul.extras-options li").removeClass("active-tab");$me.parent().addClass("active-tab");$(selector+"li.active-extra").hide().removeClass("active-extra");$(selector+"li#"+selectedTransfer).addClass("active-extra").fadeIn().parent().show()});$(".price-select").change(function(){var activityPrice=newPrice=activityAmount=totalPrice=0;var activityId=$(this).closest("li").attr("id");var decimalPoints=$(".currency").text().toLowerCase().indexOf("jpy")>=0?0:2;$("#"+activityId+" .price-select").each(function(){activityPrice=$(this).attr("data-price");activityAmount=$(this).val();totalPrice=activityPrice*activityAmount;newPrice=newPrice+totalPrice});$("#"+activityId+" .total-price span").text(newPrice.toFixed(decimalPoints))})},activitiesFunctions:function(){var selector=".activities ";var slider=$(selector+".tab-slider");var activities=$(selector+".tab-slider li").length;var width=$(selector+".tab-slider li").outerWidth(true);var totalWidth=activities*width;var maskWidth=$(selector+".tab-container").outerWidth();var scrollLimit=(totalWidth-maskWidth-17)*-1;var count=1;var newActive=0;var animating=false;var slider_position_after_animation=(slider.length>0)?slider.position().left:0;$(".activities .extras-info-item").each(function(index){$(this).find(".activity-group").first().show()});if(totalWidth<=maskWidth){$(selector+".scroll-right").addClass("right-inactive")}$(selector+".tab-slider").css("width",totalWidth+"px");$(selector+"li.extras-info-item:nth-child(1)").addClass("active-extra").show();$(selector+".extras-tab").click(function(){var selectedActivity=$(this).attr("data-id");showHotel(selectedActivity);$(selector+".extras-tab").removeClass("active-tab");$(this).addClass("active-tab");animating=true;return false});function updatedPages(page){var pages=Math.max(Math.min(page*3-2,activities),0);var pageto=Math.max(Math.min(pages+2,activities),0);$(selector+".extras-page").html("<strong>"+pages+" to "+pageto+" </strong>");$(selector+".extras-number").html("<strong>"+activities+" Activities</strong>")}updatedPages(1);function showHotel(i){if($(selector+".active-extra").length&&animating!=true){$(selector+"li.active-extra").fadeOut(function(){$(selector+"li#"+i).fadeIn().addClass("active-extra");animating=false}).removeClass("active-extra")}else{if(animating!=true){$(selector+"li#"+i).fadeIn().addClass("active-extra")}}}function showHotelAuto(i){newActive=i*3-2;$(selector+".tab-slider li:nth-child("+newActive+")").addClass("active-tab");var selectedHotel=$(selector+".tab-slider li:nth-child("+newActive+")").attr("data-id");showHotel(selectedHotel)}var checkActive=function(){if(slider_position_after_animation==5){$(selector+".scroll-left").addClass("left-inactive")}else{$(selector+".scroll-left").removeClass("left-inactive")}if(slider_position_after_animation<=scrollLimit){$(selector+".scroll-right").addClass("right-inactive")}else{$(selector+".scroll-right").removeClass("right-inactive")}};$(selector+".scroll-right").click(function(){if(slider.find(":animated").length){return false}else{if(slider_position_after_animation>scrollLimit){slider.animate({left:"-="+(width*3)},function(){checkActive()});slider_position_after_animation-=width*3;$(selector+".tab-slider li").removeClass("active-tab");count+=1;showHotelAuto(count);updatedPages(count)}}return false});$(selector+".scroll-left").click(function(){if(slider.find(":animated").length){return false}else{if(slider_position_after_animation<5){slider.animate({left:"+="+(width*3)},function(){checkActive()});slider_position_after_animation+=width*3;$(selector+".tab-slider li").removeClass("active-tab");count-=1;showHotelAuto(count);updatedPages(count)}}return false});$(".price-select").change(function(){var activityPrice=newPrice=activityAmount=totalPrice=0;var activityId=$(this).closest("li").attr("id");var decimalPoints=$(".currency").text().toLowerCase().indexOf("jpy")>=0?0:2;$("#"+activityId+" .price-select").each(function(){activityPrice=$(this).attr("data-price");activityAmount=$(this).val();totalPrice=activityPrice*activityAmount;newPrice=newPrice+totalPrice});$("#"+activityId+" .total-price span").text(newPrice.toFixed(decimalPoints))});$(".reserve-activity").click(function(){if($("div#Activities div[id*='group'] :input[value!='0']").length!==0){jetstarAncillary.reserveActivity()}return false})},reserveActivity:function(){jetstarAncillary.ativityReserved()},ativityReserved:function(){$(".activities .active-extra").addClass("activity-booked");$(".activities .active-tab").addClass("activity-reserved")},datePick:function(target,months){var flightDays=[];var returnDate,departDate;var hotelPrice,totalHotelPrice,hotelId;var dayDiff=0;$(target).focus(function(){var thisID=$(this).attr("id");if($("#"+thisID).val()==""){$("label[for="+thisID+"]").hide()}}).blur(function(){var thisID=$(this).attr("id");if($("#"+thisID).val()==""){$("label[for="+thisID+"]").show()}$("#"+thisID).removeClass("default")}).datepicker({defaultDate:+1,firstDay:1,dateFormat:"dd/mm/yy",numberOfMonths:months,minDate:0,maxDate:"+11m",minDate:0,maxDate:"+11m",dayNamesMin:["S","M","T","W","T","F","S"],beforeShow:function(input,inst){var dp=$(this),inp=input;var inputId=inp.id;var startInput=$("#"+inputId).parents(".date-wrapper").find(".start-date");var endInput=$("#"+inputId).parents(".date-wrapper").find(".end-date");if(startInput.length!=0&&endInput.length!=0){departDate=startInput.datepicker("getDate");returnDate=endInput.datepicker("getDate")}if(inputId.indexOf("txtTicketDate")==-1&&(departDate||returnDate)){var other=($("#"+inputId).hasClass("start-date")?endInput:startInput),option=($("#"+inputId).hasClass("start-date")?"maxDate":"minDate"),selectedDate=other.datepicker("getDate");dp.datepicker("option",option,selectedDate)}if(inputId.indexOf("txtTicketDate")!=-1){dp.datepicker("option","minDate",$("#"+inputId).attr("data-daterange-min"));dp.datepicker("option","maxDate",$("#"+inputId).attr("data-daterange-max"))}setTimeout(function(){addTemplate(dp,inp)},0)},beforeShowDay:checkDay,onSelect:onDaySelection,onChangeMonthYear:function(year,month,inst){var dp=$(this),inp=this;setTimeout(function(){addTemplate(dp,inp)},0)},showOn:"both",buttonImage:"//static.jetstar.com/images/clearpixel.gif",buttonImageOnly:true,showAnim:"",onClose:function(dateText,inst){var inputId=inst.id;var startInput=$("#"+inputId).parents(".date-wrapper").find(".start-date");var endInput=$("#"+inputId).parents(".date-wrapper").find(".end-date");if(startInput.length!=0&&endInput.length!=0){departDate=startInput.datepicker("getDate");returnDate=endInput.datepicker("getDate")}if($(this).hasClass("start-date")&&departDate&&!returnDate){setTimeout(function(){endInput.focus()},0)}if(departDate&&returnDate){dayDiff=(Math.ceil(returnDate-departDate)/(1000*60*60*24));hotelPrice=$(".active-extra .radio:checked").val();totalHotelPrice=Math.ceil(dayDiff)*parseInt(hotelPrice);if(dayDiff!=0){$("#"+hotelId+" .extras-price").text("$"+totalHotelPrice)}}else{$("#"+hotelId+" .extras-price").text("Please select a date")}}});$(".room-list .radio").change(function(){$(this).click()});function checkDay(date){var thisReturn=[true,""];if(departDate&&returnDate){if(date>=departDate&&date<=returnDate){thisReturn[1]="travel-window"}}var m=date.getMonth(),d=date.getDate(),y=date.getFullYear();for(i=0;i<flightDays.length;i++){if($.inArray((m+1)+"-"+d+"-"+y,flightDays)!=-1){thisReturn[0]=false}}return thisReturn}function onDaySelection(dateText,inst){var dp=inst.input;if(inst.id.indexOf("txtTicketDate")!=-1){var m=inst.currentMonth,d=inst.selectedDay,y=inst.selectedYear;d=("0"+d).slice(-2);m=("0"+(m+1)).slice(-2);var dateInQuestion=y+"-"+m+"-"+d;$(".active-extra .activity-group").hide();$('.active-extra .activity-group[data-group-time^="'+dateInQuestion+'"]').fadeIn("slow");inst.input.datepicker("hide")}if(jetstarAncillary._possibleDates){Date.format="yyyy/mm/dd";var m=inst.currentMonth,d=inst.selectedDay,y=inst.selectedYear;d=("0"+d).slice(-2);m=("0"+(m+1)).slice(-2);var dateInQuestion=y+"/"+m+"/"+d;if($.inArray(dateInQuestion,jetstarAncillary._possibleDates.date)!=-1){dp.datepicker("hide")}else{var d=jetstarAncillary._possibleDates.date,d1=Date.fromString(d[0]),d2=Date.fromString(d[d.length-1]);var day=d1.getDate(),month=d1.getMonthName(),year=d1.getFullYear();var day2=d2.getDate(),month2=d2.getMonthName(),year2=d2.getFullYear();dateString="Flights on this route have only been scheduled between <strong>"+day+" "+month+", "+year+"</strong> - <strong>"+day2+" "+month2+", "+year2+"</strong> at this point. Please select a date between this or choose a different route.";omgError(dateString)}Date.format=date_format}else{dp.datepicker("hide")}var $inputs=$(target);$.each($inputs,function(i,v){var thisID=$(v).attr("id");if($("#"+thisID).val()==""){$("label[for="+thisID+"]").show()}else{$("label[for="+thisID+"]").hide()}})}function omgError(message){setTimeout(function(){$("#ui-datepicker-div").prepend('<div class="months-3" id="dp-error" style="display: block;"><span class="icon"></span><p>'+message+"</p></div>")},1)}function addTemplate(dp,inp){$("#ui-datepicker-div").find(".header, .footer").remove();$("#ui-datepicker-div").addClass("months-"+months).prepend('<div class="header"><span class="title">'+dp.attr("title")+'</span><a href="#" class="close png-bg">Close</a></div>').find("a.close").bind("click",function(e){dp.datepicker("hide");e.preventDefault()})}}}})();$(document).ready(function(){if($("#Activities").length==0&&$(".prepaid-parking").length==0&&$("#Cars").length==0&&$("#Hotels").length==0&&$("#Transfers").length==0&&$(".ancillary-insurance").length==0){return}jetstarAncillary.init()});var Helpers=(function(){var AJAXTIMEOUT=60000;return{DoAjaxCall:function(requestType,url,data,dataType,targetContainer,preCallFunctionName,successFunctionName,completeFunctionName,onErrorCallback){if(preCallFunctionName!=undefined){preCallFunctionName()}var xhr=$.ajax({type:requestType,url:url,data:data,dataType:dataType,timeout:AJAXTIMEOUT,success:function(data){if(dataType.toUpperCase()=="JSON"){if(successFunctionName!=undefined){if(typeof(data)=="string"){data=JSON.parse(data)}data.targetId=targetContainer;successFunctionName(data)}}},error:function(jqXHR,textStatus,errorThrown){if(onErrorCallback!=undefined){var errData={};errData.jqXHR=jqXHR;errData.textStatus=textStatus;errData.errorThrown=errorThrown;errData.targetID=targetContainer;onErrorCallback(errData)}else{alert("Error encountered in DoAjaxCall(): "+textStatus+" "+errorThrown)}},complete:function(){if(completeFunctionName!=undefined){completeFunctionName()}}});return xhr},RenderToHTMLList:function renderToHTMLList(objArrayData,listID,listContent){var i,html="";for(i=0;i<objArrayData.length;i++){var obj=objArrayData[i];if(obj){html+="<li>"+listContent(obj)+"</li>"}}html='<ul id="'+listID+'">'+html+"</ul>";return html}}})();var ContentLoader=(function(){var targetID="",htmlRenderer,onErrorCallback,onSuccessfulLoading;function transformToHTML(data){var htmllist=htmlRenderer(data);$(targetID).html(htmllist);onSuccessfulLoading()}return{Init:function(options){targetID=options.TargetID;htmlRenderer=options.HTMLRenderer;onErrorCallback=options.OnErrorCallback;onSuccessfulLoading=options.OnSuccessfulLoading},Load:function(url){try{if(this.CurrentXHR&&this.CurrentXHR.readyState!=4){this.CurrentXHR.abort()}}catch(err){}this.CurrentXHR=Helpers.DoAjaxCall("GET",url,undefined,"JSON",targetID,undefined,transformToHTML,undefined,onErrorCallback)},CurrentXHR:null}})();var HotelImages=(function(){var targetID="",currURL="",prevURL="";function hotelImagesListRenderer(data){return Helpers.RenderToHTMLList(data.Images,"imageList",hotelImagesListContentRenderer)}function hotelImagesListContentRenderer(data){return'<img src="'+data.imgSrc+'" title="'+data.imgDesc+'"></img>'}function clearContainer(){$(targetID).html("")}function addLoadingUI(){$(targetID).parent().addClass("darkloading")}function removeLoadingUI(){$(targetID).parent().removeClass("darkloading")}function onSuccessfulLoadingLocal(){removeLoadingUI();var data={};data.TargetID=targetID;prevURL=currURL;onSuccessfulLoading(data)}return{Init:function(options){targetID=options.TargetID;onSuccessfulLoading=options.OnSuccessfulLoading;onErrorCallback=options.OnErrorCallback;ContentLoader.Init({TargetID:targetID,HTMLRenderer:hotelImagesListRenderer,OnSuccessfulLoading:onSuccessfulLoadingLocal,OnErrorCallback:onErrorCallback});addLoadingUI()},LoadHotelImages:function(href){currURL=href;if(prevURL!=currURL){clearContainer();addLoadingUI();ContentLoader.Load(href)}}}})();