function populateBundleTable(trigger,fareClass){var fareDataInContext={};if(isPostBookingBundle==="true"){fareDataInContext=getPlusFareDataInContext(trigger,fareClass)}else{fareDataInContext=getFareDataInContext(trigger,fareClass)}setFareClassSpecificItems(fareClass,fareDataInContext.journeyFareClass);populateBundleTableWithFareData(fareDataInContext);$("a.launch-modal.bundletable").each(function(){$(this).attr("data-modal-width",btModalWidth)})}function getPlusFareDataInContext(trigger,fareClass){var correctFlight=$(trigger).closest(".card-inner").find("div.btn-wrap input[type=checkbox]")[0];return jQuery.parseJSON($(correctFlight).attr("data-bundle"))}function getFareDataInContext(trigger,fareClass){var correctFlight=$(trigger).parents("tbody").children("tr.active-flight");var correctFareInput;if(fareClass=="STARTER"){correctFareInput=correctFlight.children("td.starter").children("div").children("input.radio[bundle-table-info]")}if(fareClass=="PLUS"){correctFareInput=correctFlight.children("td.starter").children("div").children("input.starter-plus-yes[bundle-table-info]")}if(fareClass=="MAX"){correctFareInput=correctFlight.children("td.starter").children("div").children("input.starter-max-yes[bundle-table-info]")}if(fareClass=="BUSINESS"){correctFareInput=correctFlight.children("td.business").children("div").children("input.radio[bundle-table-info]")}if(fareClass=="BUSINESSMAX"){correctFareInput=correctFlight.children("td.business").children("div").children("input.business-max-yes[bundle-table-info]")}return jQuery.parseJSON(correctFareInput.attr("bundle-table-info"))}function setFareClassSpecificItems(fareClass,journeyFareClass){var startHeader=$("div.modal-inclusions thead tr#bundleType span#starterHeaderContainer");var plusHeader=$("div.modal-inclusions thead tr#bundleType span#plusHeaderContainer");var maxHeader=$("div.modal-inclusions thead tr#bundleType span#maxHeaderContainer");var busHeader=$("div.modal-inclusions thead tr#bundleType span#busHeaderContainer");var busmaxHeader=$("div.modal-inclusions thead tr#bundleType span#bMaxHeaderContainer");var startLink=$("div.modal-inclusions a#Start");var plusLink=$("div.modal-inclusions a#Plus");var maxLink=$("div.modal-inclusions a#Max");var busLink=$("div.modal-inclusions a#Bus");var busmaxLink=$("div.modal-inclusions a#BMax");var journeyFareClassContainer=$("div.modal-inclusions thead tr#bundleType span#journeyFareClassContainer");if(startHeader!=null){if(!startHeader.hasClass("hidden")){startHeader.addClass("hidden")}}if(plusHeader!=null){if(!plusHeader.hasClass("hidden")){plusHeader.addClass("hidden")}}if(maxHeader!=null){if(!maxHeader.hasClass("hidden")){maxHeader.addClass("hidden")}}if(busHeader!=null){if(!busHeader.hasClass("hidden")){busHeader.addClass("hidden")}}if(busmaxHeader!=null){if(!busmaxHeader.hasClass("hidden")){busmaxHeader.addClass("hidden")}}if(startLink!=null){if(!startLink.hasClass("hidden")){startLink.addClass("hidden")}}if(plusLink!=null){if(!plusLink.hasClass("hidden")){plusLink.addClass("hidden")}}if(maxLink!=null){if(!maxLink.hasClass("hidden")){maxLink.addClass("hidden")}}if(busLink!=null){if(!busLink.hasClass("hidden")){busLink.addClass("hidden")}}if(busmaxLink!=null){if(!busmaxLink.hasClass("hidden")){busmaxLink.addClass("hidden")}}if(fareClass=="STARTER"){if(startHeader!=null){if(startHeader.hasClass("hidden")){startHeader.removeClass("hidden")}}if(startLink!=null){if(startLink.hasClass("hidden")){startLink.removeClass("hidden")}}}else{if(fareClass=="PLUS"){if(plusHeader!=null){if(plusHeader.hasClass("hidden")){plusHeader.removeClass("hidden")}}if(plusLink!=null){if(plusLink.hasClass("hidden")){plusLink.removeClass("hidden")}}}else{if(fareClass=="MAX"){if(maxHeader!=null){if(maxHeader.hasClass("hidden")){maxHeader.removeClass("hidden")}}if(maxLink!=null){if(maxLink.hasClass("hidden")){maxLink.removeClass("hidden")}}}else{if(fareClass=="BUSINESS"){if(busHeader!=null){if(busHeader.hasClass("hidden")){busHeader.removeClass("hidden")}}if(busLink!=null){if(busLink.hasClass("hidden")){busLink.removeClass("hidden")}}}else{if(fareClass=="BUSINESSMAX"){if(busmaxHeader!=null){if(busmaxHeader.hasClass("hidden")){busmaxHeader.removeClass("hidden")}}if(busmaxLink!=null){if(busmaxLink.hasClass("hidden")){busmaxLink.removeClass("hidden")}}}}}}}if(journeyFareClass&&journeyFareClassContainer){journeyFareClassContainer.html(" - "+journeyFareClass)}}function populateBundleTableWithFareData(fareDataInContext){var columnCount=fareDataInContext.FlightInfos.length,trbundleFlights=$("tr#bundleFlights"),trMapping={FLIGHTS:trbundleFlights,WIDELEATHERSEAT:$("tr#bundleLeatherSeat"),CARRYONBAGGAGE:$("tr#bundleCarryOnBaggage"),BUSMAXBAGGAGE:$("tr#bundleBusMaxCheckedBaggage"),STARTERMAXBAGGAGE:$("tr#bundleStarterMaxCheckedBaggage"),QFF:$("tr#bundlePoints"),MEAL:$("tr#bundleMeals"),INFLIGHTVOUCHER:$("tr#bundleVouchers"),SEATSELECTION:$("tr#bundleSeats"),CHANGEFEE:$("tr#bundleChanges"),FLEXIBLE:$("tr#bundleFlexible"),REFUNDABLE:$("tr#bundleRefundable"),ENTERTAINMENT:$("tr#bundleEntertainment"),FULLMEAL:$("tr#bundleFullMeal"),COMFORTPACK:$("tr#bundleComfortPack"),BUSINESSLOUNGEACCESS:$("tr#bundleBusinessLoungeAccess"),STARTERLOUNGEACCESS:$("tr#bundleStarterLoungeAccess"),STARTERPLUSPROTECT:$("tr#bundleStarterPlusProtect"),STARTERMAXPROTECT:$("tr#bundleStarterMaxProtect")};if(fareDataInContext.InflightVoucherTitle){$("tr#bundleVouchers").find("#voucherLabel").html(fareDataInContext.InflightVoucherTitle)}$.each(trMapping,function(name,container){if(container!==null){if(!container.hasClass("hidden")){container.addClass("hidden")}if(container.children("td:not(.first)")){container.children("td:not(.first)").remove()}}});$.each(fareDataInContext.FlightInfos,function(index,flightinfo){if(trbundleFlights!=null&&(flightinfo.FlightDesignator!=null||flightinfo.Origin!=null||flightinfo.Destination!=null)){var newNode=btFlightHeader;newNode=newNode.replace("{0}",flightinfo.FlightDesignator);newNode=newNode.replace("{1}",flightinfo.Origin);newNode=newNode.replace("{2}",flightinfo.Destination);trbundleFlights.append(newNode);trbundleFlights.removeClass("hidden")}$.each(flightinfo.BundleItemList,function(index,bundleItem){var newNode=btNone,falseValues=["False","NONE"],isNeeded=false,seatsValuesMap={PLUS:btSeatsPlus,MAX:btSeatsMax,BUS:btSeatsBus},changeFeeValuesMap={PLUS:btChangePlus,MAX:btChangeMax,BUS:btChangeBus};if(trMapping[bundleItem.Name]){if($.inArray(bundleItem.Value,falseValues)===-1){isNeeded=true;newNode=$(newNode).html(bundleItem.Value).text();if(bundleItem.SegmentBased&&$(newNode).length>0){newNode=$(newNode).attr("colspan",bundleItem.SegmentBased)[0].outerHTML}else{if(bundleItem.Name==="MEAL"){newNode=btMeals}else{if(bundleItem.Name==="SEATSELECTION"&&seatsValuesMap[bundleItem.Value]){newNode=seatsValuesMap[bundleItem.Value]}else{if(bundleItem.Name==="CHANGEFEE"&&changeFeeValuesMap[bundleItem.Value]){newNode=changeFeeValuesMap[bundleItem.Value]}else{if(bundleItem.Name==="FLEXIBLE"){newNode=btFlexibleTrue}else{if(bundleItem.Name==="REFUNDABLE"){newNode=btRefundableTrue}else{if(bundleItem.Name=="STARTERPLUSPROTECT"){newNode=btNone;if(bundleItem.Value=="GK"){if(btPlusProtect!=="undefined"){newNode=btPlusProtect}}else{isNeeded=false}}else{if(bundleItem.Name=="STARTERMAXPROTECT"){newNode=btNone;if(bundleItem.Value=="GK"){newNode=btMaxProtect}else{isNeeded=false}}else{if(bundleItem.Value==="True"){newNode=btCheck}}}}}}}}}}trMapping[bundleItem.Name].append(newNode);if(trMapping[bundleItem.Name].hasClass("hidden")&&isNeeded){trMapping[bundleItem.Name].removeClass("hidden")}}})});if(columnCount<=3){btModalWidth=225+columnCount*150}$("#overlay").css({width:btModalWidth+"px"});$("div.modal-inclusions tr#bundleType th[colspan]").attr("colspan",columnCount)};