var ancillaryVouchers=(function($,window,document){var isIE7=$("html").hasClass("ie7"),isIE8=$("html").hasClass("ie8"),perFlightSelectorClass=".per-flight-selection",perPaxSelectorClass=".per-pax-selection",checkedClass="checked",selectedClass="selected",initialization=function(){setup();equalizeHeights();toggleGroupSelection();individualize();bindingPerFlight.init();bindingPerPax.init()},$el={},setup=function(){$el.swiperContainer=$(".swiper-container");$el.ancillaryContainer=$(".ancillary-voucher");$el.PanelContainer=$el.ancillaryContainer.find(".panel-content");$el.ancillaryContainer=$(".ancillary-content");$el.NavCarousel=$(".navi-top");$el.tabItem=$el.NavCarousel.find(".owl-item")},panelInit=function(){var initWait=1000;setTimeout(function(){$el.PanelContainer.removeClass("init")},initWait)},bindingPerFlight={perFlightWrapper:$(perFlightSelectorClass),init:function(){this.bindTrigger()},bindTrigger:function(){this.perFlightWrapper.each(function(a,b){var $this=$(this),$btnWrapper=$this.find(".group-selection > li"),$input=$btnWrapper.find("input"),$validInput=$input.filter(function(){return $(this).attr("data-toggle-val")=="valid"});$input.on("change",function(e){e.stopImmediatePropagation();var $this=$(this),$parentContainer=$this.parents(".ancillary-content"),countFlightRow=$parentContainer.find(perFlightSelectorClass).length,$row=$this.parents(perFlightSelectorClass),currentTab=$parentContainer.parents(".panel-content-ancillary").index();if($validInput.is(":checked")){setRow($row,checkedClass,true)}else{setRow($row,checkedClass,false)}var cntSelectedRow=$parentContainer.find(perFlightSelectorClass).filter(".checked").length;if(cntSelectedRow){tabState.selectTab(currentTab);if(cntSelectedRow===countFlightRow){tabState.nextTab(currentTab)}}else{tabState.deselectTab(currentTab)}return false})})}},bindingPerPax={perPaxWrapper:$(perPaxSelectorClass),init:function(){this.bindTrigger()},bindTrigger:function(){this.perPaxWrapper.each(function(){var $this=$(this),$paxRow=$this.find(".pax-row"),$btnWrapper=$this.find(".group-selection > li"),$input=$btnWrapper.find("input"),$validInput=$input.filter(function(){return $(this).attr("data-toggle-val")=="valid"});$paxRow.each(function(){var $input=$btnWrapper.find("input");$input.on("change",function(e){e.stopImmediatePropagation();var $this=$(this),$parentContainer=$this.parents(".ancillary-content"),countFlightRow=$parentContainer.find(perPaxSelectorClass).length,$row=$this.parents(perPaxSelectorClass),rowInputLen=$row.find(".pax-row").length,currentTab=$parentContainer.parents(".panel-content-ancillary").index(),$rowSelectedVoucher=$input.filter(function(){return $(this).attr("data-toggle-val")=="valid"}),countCheckRow=$rowSelectedVoucher.filter(":checked").length;if($validInput.is(":checked")){setRow($row,checkedClass,true)}else{setRow($row,checkedClass,false)}if(rowInputLen===countCheckRow){setRow($row,selectedClass,true)}else{setRow($row,selectedClass,false)}var cntPax=$parentContainer.find(perPaxSelectorClass).filter(".checked").length,cntSelectRow=$parentContainer.find(perPaxSelectorClass).filter(".selected").length;if(cntPax){tabState.selectTab(currentTab);if(cntSelectRow===countFlightRow){tabState.nextTab(currentTab)}}else{tabState.deselectTab(currentTab)}return false})})})}},setRow=function(row,setClass,bool){var selectRow=bool,$row=row;if(selectRow){$row.addClass(setClass)}else{$row.removeClass(setClass)}},tabState={bookedClass:"booked",selectTab:function(tabIndex){$el.tabItem.eq(tabIndex).addClass(this.bookedClass)},deselectTab:function(tabIndex){$el.tabItem.eq(tabIndex).removeClass(this.bookedClass)},nextTab:function(tabIndex){var progressWait=500;setTimeout(function(){$el.tabItem.eq(tabIndex+1).trigger("click")},500)}},toggleGroupSelection=function(){$el.ancillaryContainer.each(function(){var $this=$(this),$toggler=$this.find(".manage-toggler"),$togglerInput=$toggler.find("input"),$perFlightTrigger=$toggler.find(".btn-is-default > button"),$perPaxTrigger=$toggler.find(".btn-is-selected > button"),$perFlightSelection=$this.find(perFlightSelectorClass),$perPaxSelection=$this.find(perPaxSelectorClass);if($togglerInput.is(":checked")){$perPaxSelection.hide();$perFlightSelection.show()}else{$perFlightSelection.hide();$perPaxSelection.show()}$perPaxTrigger.click(function(event){if(isIE7==true){$perFlightSelection.hide();$perPaxSelection.show()}else{$perFlightSelection.slideUp();$perPaxSelection.slideDown()}});$perFlightTrigger.click(function(){if(isIE7==true){$perPaxSelection.hide();$perFlightSelection.show()}else{$perPaxSelection.slideUp();$perFlightSelection.slideDown()}})});panelInit()},individualize=function(){$(perFlightSelectorClass).each(function(){var $this=$(this);$trigger=$this.find("label");$trigger.click(function(){var $this=$(this),index=$this.parents("li").index(),$flightRow=$this.parents(perFlightSelectorClass),$perPaxRow=$flightRow.siblings(),$paxSelectList=$perPaxRow.find(".group-selection"),$paxSelectTrigger=$paxSelectList.find("li:eq("+index+") > label");$paxSelectTrigger.trigger("click")})})},equalizeHeights=function(){var voucherContainer=$(".ancillary-voucher");var $col=$(perPaxSelectorClass,voucherContainer).find("li label"),highestBox=0;var isVisible=voucherContainer.is(":visible");if(!isVisible){voucherContainer.show()}$col.each(function(){if($(this).height()>highestBox){highestBox=$(this).height()}});if(highestBox!==0){$col.height(highestBox)}if(!isVisible){voucherContainer.hide()}};return{init:initialization}})(_$,window,document);_$(document).ready(function(){ancillaryVouchers.init()});